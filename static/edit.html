<!DOCTYPE html>
<html>
	<head>
		<title>Editor</title>
		<link href='http://fonts.googleapis.com/css?family=Anonymous+Pro:400,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="/static/css/style.css">
		<link rel="stylesheet" type="text/css" href="/static/css/edit.css">
		<style type="text/css">
		</style>
	</head>
	<body>
		<div class = 'title'></div>
		<div class = 'buttons'>
			<div class = 'button' id = 'done'>done</div>
			<div class = 'button' id = 'save'>save</div>
			<div class = 'button' id = 'toggleSplit'>toggle preview</div>
		</div>
		<div id = 'lcol'>
<pre id="editor">function foo(items) {
	var i;
	for (i = 0; i &lt; items.length; i++) {
			alert("Ace Rocks " + items[i]);
	}
}</pre>
		</div>
		<div id = 'separator'>
			<div style = 'width:7px;height:100%;position:absolute;border:#232323 1px solid;'>
			</div>
			<div style = 'position:absolute;top:50%;margin-top:-10px;height:20px;width:7px;'>
				<div style = 'margin-left:2px;border-radius:5px;width:3px;height:3px;border:1px solid #232323;'>
				</div>
				<div style = 'margin-left:2px;border-radius:5px;margin-top:3px;width:3px;height:3px;border:1px solid #232323;'>
				</div>
			</div>
		</div>
		<div id = 'rcol'>
			<iframe id = 'preview' src = "http://microsoft.com" style = 'width:100%;height:100%;border:none;padding:0;margin:0;margin:3px;'></iframe>
			<div id = 'cover' style = 'position:absolute;width:100%;height:100%;top:0;left:0;background-color:rgba(0, 0, 0, 0);z-index:-1;'></div>
		</div>
		<script type='text/javascript' src='/static/js/jquery.js'></script>
		<script type='text/javascript' src='/static/js/helpers.js'></script>
		<script type='text/javascript' src='/static/js/columns.js'></script>
		<script src="/static/js/ace/ace.js" type="text/javascript" charset="utf-8"></script>
		<script>
			$('#toggleSplit').bind('click', toggleSplit);
			$('#save').bind('click', save);
			$('#done').bind('click', done);

			$('.title').html(join('codezoo/',window.location.pathname));
			var editor = ace.edit("editor");
			editor.setOption("showPrintMargin", false);
			editor.setTheme("ace/theme/dawn");
			editor.getSession().setMode("ace/mode/javascript");

			function toggleSplit() {

			}

			function save() {
				$.ajax({
					type:"POST",
					url:'/write',
					data:{
						content:editor.getSession().getValue(),
						path:window.location.pathname
					},
					success:function() {
						alert("save worked");
					},
					dataType:'JSON'

				});
			}

			function done() {
				$.ajax({
					type:"POST",
					url:'/write',
					data:{
						content:editor.getSession().getValue(),
						path:window.location.pathname
					},
					success:function() {
						alert("save worked");
						window.location = '/view/' + window.location.pathname.substr('/edit/'.length);
					},
					dataType:'JSON'

				});
			}

		</script>
	</body>
</html>